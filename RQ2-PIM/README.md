# RQ2: PIM Metamodel

<br/>

PIM metamodel diagram is provided below (click on the image to view it in full size)

<img src="https://github.com/MiSAR-A/Journal-Results/blob/master/RQ2-PIM/images/PIM.png" />

<br/>

As a result of our empirical study, we introduce our updated version of **MISAR** microservice architecture metamodel as shown in the above Figure. The new version aimed to be generic, extendible and more comprehensive in order to model almost any microservice architecture built in any platform or technology.  In regard to RQ2, this metamodel is supposed to comprehensively model microservices along with service pattern components implemented in them including server components and client components. Our enhanced metamodel is intended to provide a way to define microservice architecture from static structure and dynamic interaction points of view. Explanation of updated concepts in the result model is provided as the following:

PSM Concept | PSM Attribute(s) | Description
------------ | ------------- | -------------
`MicroservicesArchitectureModel` | `ArchitectureName` | It models microservice architecture from *static* and *interaction* points of view. It particularly represents: (a) **deployment** aspect concerning the environment where microservices are deployed to. Elements capturing that aspect include: `Ambient` and `Container`, (b) **microservice repository** aspect concerning the set of all microservices, their types, e.g. functional or infrastructure, and pattern components. Elements capturing that aspect include: `Microservice`, `FunctionalMicroservice`, `InfrastructureMicroservice`, `ServicePatternComponent`, `ServerComponent` and `ClientComponent`. (c) **interaction interface** aspect concerning the messaging mechanism that microservices use to communicate with its clients. It defines two basic interaction styles; *synchronous* and *asynchronous*. Elements capturing that aspect include: `ServiceInterface`, `ServiceDestination`, `SynchronousServiceDestination`, `RestEndpoint`, `AsynchronousServiceDestination`, `AmqpExchange`, `AmqpQueue`, `InboundQueue`, `OutboundQueue`, `ServiceOperation` and `ServiceMessage`. (d) **inter-microservice interaction** aspect concerning the inter-service dependency and exchange of information communication among microservices composing an architecture. It doesn’t represent communications that occur from outside the architecture. One element capturing this aspect is `ServiceDependency`. 
`SystemProjectArtifactFile`| `FileName` | this element generalizes files that configure building, orchestrating and integrating all modules/application projects aggregated in a microservice-based architecture project. `SystemProjectArtifactFile` element is described by its file name including full path as well as by the system’s project name to which this file belongs. According to our empirical study, there were two classes of such file type appeared in all stud-ies, namely, `DockerComposeFile` and `SystemProjectBuildFile`. Aiming to make our PSM extendible and reusable, we assumed that there may be more than two subtypes of such file.
`DockerComposeFile` | | this element maps to Docker compose file, i.e. a YAML file that defines orchestration of microservice applica-tions’ containers at runtime and other network-related information, i.e. links among containers. One `DockerComposeFile` represents one consolidated Docker compose file that has many service definition keys, mapped to `ContainerDefinition` elements, each has zero or many ‘links’ / ’depends_on’ keys, mapped to `ContainerDependency` elements.
`ContainerDefinition` | `ServiceName`, `ImageField`, `BuildField`, `LoggingField`, `VolumesLogField` | this element may refer to a local microservice project, mapped by `MicroserviceProjectArtifactsModel` element, or to an image of an external service, e.g. located in Docker hub repository.  
`ContainerDependency` | `DependencyOrder` | this element represents an ordered dependency association between one dependent / consumer `ContainerDefinition` element to one or many `ContainerDefinition` ‘provider’ elements. 
`SystemProjectBuildFile` | `ProjectArtifactId` | this element is a generalization of any artefact generated by a build framework used to compile the root project along with its subprojects. For example, two frameworks were found in the selected studies used to build `Spring Boot` applications; `Maven`and `Gradle`. Maven build file is an XML representation of a project held in a file named `pom.xml`. POM stands for "Project Object Model". A **Maven** project could represent an entire system project or an individual micro service’s project. A system root project consisting of subprojects and built by Maven framework will have names of its subprojects enclosed between `<module></module>` XML ele-ment. **Gradle** build file is a settings file used by Gradle framework to assemble the project description, its sub-projects and dependencies for a build. Its name is `settings.gradle` and it uses `include` commands to build related subprojects. Unsurprisingly, a `SystemProjectBuildFile` element references all ‘local’ subprojects constructing an architecture project where each subproject is represented by `MicroserviceProjectArtifactsModel` element. 
`MicroserviceProjectArtifactsModel` | `ModuleName` | this element is simply an aggregation of all artefacts generated by `Spring Framework` and related to one ‘local’ microservice project composing an architecture project. `MicroserviceProjectArtifactsModel` has elements corresponding to a particular type of microservice project artefact file. 

